
# 邮箱Agent MVP详细需求文档（含MCP工具集成）

---

## 一、项目定位

1. 本地运行的桌面邮件助手，支持 Windows、Linux、MacOS 平台。
2. 主要服务企业邮箱（初期仅支持 Outlook、PrivateEmail），通过 IMAP 协议收取邮件。
3. 集成 AI 能力：自动邮件摘要、分类、建议回复，支持多轮对话、工具调用。
4. 引入 MCP（Model Context Protocol）协议，支持模型自主调用工具（如 cline 一样），实现可扩展的 AI 能力。
5. 前端、后端本地运行，易于未来云端部署。

---

## 二、技术选型

* 前端：Vue 3 + Electron（桌面跨平台应用）
* 后端：Python（Flask 或 FastAPI，负责IMAP、AI、MCP工具中转、上下文管理等）
* 数据库：SQLite（轻量、本地、免安装）
* AI接口：通过 MCP 协议调用 OpenRouter API（或后续接入更多大模型）
* 邮箱协议：IMAP
* MCP Tool Server：可用 Node.js 版本，或自定义实现（通过HTTP/JSON通信）

---

## 三、功能需求

### 1. 用户与账号管理

* 用户可添加、删除邮箱账号（支持IMAP手动配置：服务器地址、端口、账号、密码）
* 支持多邮箱账号管理（MVP可仅支持单账号，保留扩展）
* 用户可配置 MCP Provider 信息与 OpenRouter API Key（通过设置界面）

### 2. 邮件收取与管理

* 自动/手动通过 IMAP 拉取未读邮件，存储到本地 SQLite 数据库
* 展示邮件列表（按收件时间倒序，支持刷新）
* 邮件详情页，展示完整正文、附件、发件人、主题等
* 支持标记邮件为已读/未读、重要，支持简单文件夹归类/标签（如“收件箱”、“广告”、“重要”）

### 3. AI邮件助手（MCP集成）

* 用户可在任意邮件详情页中与AI进行多轮交互（chatbot方式）：

  * 邮件摘要：自动提炼要点
  * 邮件分类：判断邮件类型（如广告、业务、客户等）
  * 回复建议：AI基于邮件上下文生成建议回复
  * 翻译：AI翻译邮件内容
  * 其它MCP工具支持的操作（如自动归档、查找历史邮件等）
* 支持MCP工具注册与管理（如“邮件翻译器”“历史邮件查找器”等），工具列表动态注入
* 模型通过 MCP 协议自主判断是否需要调用哪些工具（如cl ine机制），工具调用链路由后端中转并统一上下文管理

### 4. MCP协议/工具调用

* 后端内置MCP中转逻辑：

  * 可配置 MCP Tool Server 地址（本地/远程均可）
  * 支持与Node.js等语言实现的 MCP Tool Server 通信（HTTP/JSON）
  * 后端作为模型与 MCP Tool Server 的中介，处理多轮工具调用
* 工具调用请求与响应全部标准化，模型可主动选择调用与否，MVP预置2\~3个工具（如邮件翻译、邮件归类）

### 5. 数据存储

* SQLite 本地存储

  * 邮箱账号配置（加密保存敏感信息）
  * 邮件元数据（ID、主题、正文摘要、发件人、收发时间、标签等）
  * 用户设置（API Key、MCP Provider 配置）
  * AI与工具交互记录（方便后续上下文检索与个性化）
  * MCP调用日志、工具使用统计等

### 6. 前端交互与界面

* 典型邮件客户端布局：

  * 左侧：邮箱文件夹/标签导航栏
  * 中间：邮件列表（含搜索/筛选）
  * 右侧：邮件详情区+AI助手对话框
* 设置页：邮箱账号、API Key、MCP Provider配置、工具管理
* 支持复制AI建议、编辑回复（AI仅生成内容，用户最终确认后手动发送）
* 界面需适配常见分辨率，基础美观友好

### 7. 安全与隐私

* 敏感配置本地加密存储
* 邮箱密码/Token加密，仅本地处理，不上传云端
* 日志与AI上下文仅用于本地功能优化，用户可随时清理

### 8. 系统与架构

* 支持 Windows、Linux、MacOS 一键打包分发
* 可配置本地/云端 MCP Tool Server 地址，便于未来扩展和迁移
* 前后端分离设计，后端暴露RESTful接口供前端/Electron调用

---

## 四、MVP阶段交付标准

1. 用户可通过 IMAP 成功登录并收取/展示本地邮件
2. 支持基本的邮件管理（已读/未读、重要、简单标签/分类）
3. 集成OpenRouter（通过MCP协议），可用AI自动摘要、回复建议、翻译等
4. MCP Tool Server至少内置2个工具（如翻译、归类），模型能自主决定工具调用
5. 所有核心数据均本地持久化，保证数据安全和隐私
6. 提供基础但完整的桌面客户端UI，简单易用
7. 提供完整的README与部署/运行文档

---

## 五、未来可扩展点（MVP后置）

* 多账号、多模型、丰富MCP工具注册与管理
* 云端部署（Vercel、AWS等）
* 更智能的自动化规则引擎
* 多用户与团队协作
* 邮件自动下载附件、财务自动填表等高级自动化
* Web端、移动端适配

---